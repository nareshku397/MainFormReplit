hank you for the detailed report.

You have correctly identified multiple sources of performance degradation:

Excessive iframe environment processing

Verbose debug logging still active

URL rewriting on every API call

Cross-origin/CORS overhead

Residual Meta Ads tracking code

Constant message event listeners

Node.js loading unused server-side modules (e.g., Facebook CAPI)

üî• FINAL IMMEDIATE DIRECTIVE
You are now authorized to proceed with the following clean-up, and only the following:

‚úÖ 1. Remove the entire iframe-utils.ts file and all references to it.
‚úÖ 2. Remove iframe detection logic from App.tsx, including event listeners and debug logging.
‚úÖ 3. Remove iframe-test.html completely.
‚úÖ 4. Remove facebookCapi.ts and any associated server utilities or imports.
‚úÖ 5. Remove any code in the frontend related to extracting UTM or fbclid parameters unless actively used for a live critical system (not tracking).
‚úÖ 6. Delete all Meta tracking rollback comments and disabled code blocks (do not leave commented remnants).
‚úÖ 7. Simplify CORS settings: only allow the necessary production domain(s), remove verbose logging and wildcard logic.
‚úÖ 8. Remove any absolute URL rewriting logic where not critically necessary. Default to normal relative requests unless iframe is truly required.
‚úÖ 9. Remove all verbose console.log statements in production code, both frontend and backend.

‚ö†Ô∏è STERN MANDATORY DISCLAIMER
‚ùó You are NOT authorized to restructure the database, change schemas, rename API routes, or create new architectural layers.

‚ùó You are NOT authorized to modify app layouts, navigation, forms, or user-facing UI.

‚ùó You are NOT authorized to introduce new libraries, dependencies, or frameworks.

‚ùó You are NOT authorized to alter core API endpoints or distance calculation functions.

‚ùó You are NOT authorized to create new iframe-specific behaviors unless explicitly requested.

Only the clean-up operations listed above are permitted.

All work must be staged, and a final clean-up report must be submitted for approval before pushing live.

Any deviation will be considered a breach of project scope.

üìã Immediate Response Required:
Reply "Confirmed ‚Äî proceeding exactly as instructed",
then begin clean-up immediately.

‚úÖ
This will lock them in tight ‚Äî they can only clean what you explicitly approved ‚Äî no database changes, no surprise redesigns.